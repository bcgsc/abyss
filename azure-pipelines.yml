jobs:

- job: macOS_default_gcc
  pool:
    vmImage: macOS-11
  steps:
  - script: |
      rm -f /usr/local/bin/2to3 # brew is having issues with installing Python
      brew update
      brew install automake boost openmpi google-sparsehash make pandoc ghc
    displayName: Install common
  - script: |
      ./autogen.sh
      ./configure --with-boost=/usr/local/opt/boost --with-mpi=/usr/local/opt/openmpi --with-sparsehash=-I/usr/local/opt/google-sparsehash
      make -j12 distcheck
    displayName: Compiling ABySS with default gcc

- job: macOS_default_clang
  pool:
    vmImage: macOS-11
  steps:
  - script: |
      rm -f /usr/local/bin/2to3 # brew is having issues with installing Python
      which brew
      brew update
      brew install automake boost openmpi google-sparsehash make pandoc ghc llvm
    displayName: Install common
  - script: |
      ./autogen.sh
      export DISTCHECK_CONFIGURE_FLAGS="CC=clang CXX=clang++"
      ./configure CC=clang CXX=clang++ --with-boost=/usr/local/opt/boost --with-mpi=/usr/local/opt/openmpi --with-sparsehash=-I/usr/local/opt/google-sparsehash
      make -j12 distcheck
    displayName: Compiling ABySS with default clang
